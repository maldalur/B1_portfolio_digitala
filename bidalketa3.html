<!DOCTYPE html>
<html lang="eu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B1.3 Hirugarren Bidalketa - B1 Portfolio</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“¦ B1.3 Hirugarren Bidalketa</h1>
            <p>Eduki Digitalen Irisgarritasuna eta Ikaskuntza Pertsonalizazioa</p>
        </header>
        
        <nav class="main-nav">
            <a href="index.html">ğŸ“‹ Sarrera</a>
            <a href="bidalketa1.html">ğŸ“¦ B1.1 Lehen Bidalketa</a>
            <a href="bidalketa2.html">ğŸ“¦ B1.2 Bigarren Bidalketa</a>
            <a href="bidalketa3.html" class="active">ğŸ“¦ B1.3 Hirugarren Bidalketa</a>
        </nav>
        
        <!-- IRAKURKETA MODUA / MODO LECTURA POR VOZ -->
        <div id="audioReaderPanel" style="position: fixed; bottom: 20px; left: 20px; z-index: 1000; background: white; border-radius: 15px; padding: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); display: none;">
            <div style="margin-bottom: 10px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #667eea;">ğŸŒ Hizkuntza / Idioma:</label>
                <select id="languageSelect" onchange="changeLanguage()" style="width: 100%; padding: 8px; border: 2px solid #667eea; border-radius: 8px; font-size: 14px; cursor: pointer;">
                    <option value="es-ES">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
                    <option value="eu-ES">ğŸ‡ªğŸ‡º Euskara</option>
                    <option value="en-US">ğŸ‡¬ğŸ‡§ English</option>
                    <option value="fr-FR">ğŸ‡«ğŸ‡· FranÃ§ais</option>
                </select>
            </div>
            <div style="display: flex; gap: 10px; justify-content: center;">
                <button id="playPauseBtn" onclick="togglePlayPause()" 
                        style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
                               color: white; 
                               border: none; 
                               border-radius: 10px; 
                               padding: 10px 20px; 
                               font-size: 20px; 
                               cursor: pointer; 
                               box-shadow: 0 2px 8px rgba(0,0,0,0.2);
                               transition: all 0.3s ease;">
                    â–¶ï¸ Play
                </button>
                <button onclick="closeAudioPanel()" 
                        style="background: #dc3545; 
                               color: white; 
                               border: none; 
                               border-radius: 10px; 
                               padding: 10px 20px; 
                               font-size: 14px; 
                               cursor: pointer; 
                               box-shadow: 0 2px 8px rgba(0,0,0,0.2);
                               transition: all 0.3s ease;">
                    âŒ Itxi
                </button>
            </div>
        </div>
        
        <!-- BotÃ³n flotante para abrir el panel -->
        <div style="position: fixed; bottom: 20px; left: 20px; z-index: 999;">
            <button id="audioReaderBtn" onclick="openAudioPanel()" 
                    style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
                           color: white; 
                           border: none; 
                           border-radius: 50%; 
                           width: 60px; 
                           height: 60px; 
                           font-size: 24px; 
                           cursor: pointer; 
                           box-shadow: 0 4px 10px rgba(0,0,0,0.3);
                           transition: all 0.3s ease;">
                ğŸ”Š
            </button>
        </div>
        
        <div class="content">
            <!-- SARRERA -->
            <section>
                <h2>ğŸ“‹ Sarrera</h2>
                <div class="task-card">
                    <p style="font-size: 1.1em;">
                        Hirugarren bidalketa honetan <strong>irisgarritasun hobekuntzak</strong> aurkezten ditut sortutako eduki digitalentzako:
                    </p>
                    <ul style="margin-top: 20px; margin-left: 20px; font-size: 1.05em; line-height: 1.8;">
                        <li>â™¿ <strong>5.A Ataza:</strong> Eduki digitalen irisgarritasuna</li>
                        <li>ğŸ¯ <strong>5.B Ataza:</strong> Ikaskuntza pertsonalizazioa</li>
                    </ul>
                </div>
            </section>

            <!-- 5.A ATAZA: IRISGARRITASUNA -->
            <section id="irisgarritasuna">
                <h2>â™¿ 5.A Ataza: Eduki Digitalen Irisgarritasuna</h2>
                
                <div class="task-card">
                    <h3>ğŸ¯ Helburua</h3>
                    <p>Sortutako eduki digitalak (2.A eta 2.B atazak) irisgarriak egitea, desgaitasuna edo zailtasunak dituzten ikasleentzako.</p>
                </div>
                
                <div class="task-card">
                    <h3>âœ¨ Gehitutako Irisgarritasun Elementuak</h3>
                    
                    <div class="feature-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                        
                        <!-- Irakurketa Modua -->
                        <div class="feature-item" style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 4px solid #667eea;">
                            <h4 style="color: #667eea; margin-bottom: 10px;">ğŸ”Š Audio Bidezko Irakurketa</h4>
                            <p style="margin-bottom: 15px;"><strong>Zer da?</strong> Text-to-Speech teknologia erabiliz, webguneko eduki guztia audio bidez entzuteko aukera.</p>
                            
                            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                                <h5 style="color: #764ba2; margin-bottom: 8px;">Ezaugarriak:</h5>
                                <ul style="margin-left: 20px; line-height: 1.8;">
                                    <li>â–¶ï¸ <strong>Play/Pause kontrolak</strong> - Irakurketa kontrolatzeko</li>
                                    <li>ğŸŒ <strong>Hizkuntza aukeraketa</strong> - Euskara, Gaztelania, Ingelesa, Frantsesa</li>
                                    <li>ğŸ’¡ <strong>Nabarmentze bisuala</strong> - Irakurtzen ari den testua nabarmenduta</li>
                                    <li>âš¡ <strong>Abiadura egokitua</strong> - 0.85x abiadura, ulertzeko errazagoa</li>
                                </ul>
                            </div>
                            
                            <div style="background: #e8f4f8; padding: 10px; border-radius: 8px;">
                                <p style="margin: 0;"><strong>ğŸ“ Onura:</strong> Ikusmen arazoak dituzten ikasleek edo irakurketa zailtasunak dituztenek edukia entzun dezakete.</p>
                            </div>
                        </div>
                        
                        <!-- Irakurketa Modua -->
                        <div class="feature-item" style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 4px solid #28a745;">
                            <h4 style="color: #28a745; margin-bottom: 10px;">ğŸ“– Irakurketa Modua</h4>
                            <p style="margin-bottom: 15px;"><strong>Zer da?</strong> Testu tamaina handiagorik eta lerro arteko espazioa handiagoarekin, irakurketa errazteko.</p>
                            
                            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                                <h5 style="color: #28a745; margin-bottom: 8px;">Hobekuntzak:</h5>
                                <ul style="margin-left: 20px; line-height: 1.8;">
                                    <li>ğŸ“ <strong>Lerro arteko espazioa</strong> - 1.8x espazioa (normala: 1.6x)</li>
                                    <li>ğŸ“ <strong>Paragrafo espazioa</strong> - Paragrafo artean espazio handiagoa</li>
                                    <li>ğŸ¨ <strong>Kontraste handiagoa</strong> - Atzeko plano-kolore zuriago eta letra beltzagoa</li>
                                    <li>ğŸ“Š <strong>Lerro zabalera mugatua</strong> - Max 900px, irakurketa erosoagoa</li>
                                </ul>
                            </div>
                            
                            <div style="background: #d4edda; padding: 10px; border-radius: 8px;">
                                <p style="margin: 0;"><strong>ğŸ“ Onura:</strong> Dislexia edo beste irakurketa zailtasunak dituzten ikasleentzako erosoagoa.</p>
                            </div>
                        </div>
                        
                        <!-- Kontraste Altua -->
                        <div class="feature-item" style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 4px solid #ffc107;">
                            <h4 style="color: #ffc107; margin-bottom: 10px;">âš«âšª Kontraste Altua</h4>
                            <p style="margin-bottom: 15px;"><strong>Zer da?</strong> Letra beltz osoa atzeko plano zuri gainean, ikusgarritasun maximoa lortzeko.</p>
                            
                            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                                <h5 style="color: #ffc107; margin-bottom: 8px;">Aldaketak:</h5>
                                <ul style="margin-left: 20px; line-height: 1.8;">
                                    <li>ğŸ¨ <strong>Koloreak</strong> - Letra: #000 (beltz osoa), Fondoa: #fff (zuri osoa)</li>
                                    <li>ğŸ”² <strong>Ertz definituak</strong> - Elementu guztien ertzak nabarmenagoak</li>
                                    <li>ğŸ’« <strong>Trantsizio efektuak kenduak</strong> - Distrakzio gutxiago</li>
                                </ul>
                            </div>
                            
                            <div style="background: #fff3cd; padding: 10px; border-radius: 8px;">
                                <p style="margin: 0;"><strong>ğŸ“ Onura:</strong> Ikusmen urria edo koloreen zeharkako arazoak dituzten ikasleentzako.</p>
                            </div>
                        </div>
                        
                        <!-- Testu Handiagoa -->
                        <div class="feature-item" style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 4px solid #dc3545;">
                            <h4 style="color: #dc3545; margin-bottom: 10px;">ğŸ” Testu Handiagoa</h4>
                            <p style="margin-bottom: 15px;"><strong>Zer da?</strong> Letra tamaina handiagorik erabiliz, irakurketa errazteko.</p>
                            
                            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                                <h5 style="color: #dc3545; margin-bottom: 8px;">Tamainak:</h5>
                                <ul style="margin-left: 20px; line-height: 1.8;">
                                    <li>ğŸ“ <strong>Testu arrunta</strong> - 18px (normala: 16px)</li>
                                    <li>ğŸ“ <strong>Titulu txikiak (h3)</strong> - 24px (normala: 20px)</li>
                                    <li>ğŸ“Š <strong>Titulu handiak (h2)</strong> - 30px (normala: 26px)</li>
                                </ul>
                            </div>
                            
                            <div style="background: #f8d7da; padding: 10px; border-radius: 8px;">
                                <p style="margin: 0;"><strong>ğŸ“ Onura:</strong> Ikusmen urria edo presbizia duten ikasleentzako.</p>
                            </div>
                        </div>
                        
                        <!-- Espaziamendu Zabala -->
                        <div class="feature-item" style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 4px solid #6f42c1;">
                            <h4 style="color: #6f42c1; margin-bottom: 10px;">â†”ï¸ Espaziamendu Zabala</h4>
                            <p style="margin-bottom: 15px;"><strong>Zer da?</strong> Hitz arteko espazioa handiagorik, hitzak bereizten errazteko.</p>
                            
                            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                                <h5 style="color: #6f42c1; margin-bottom: 8px;">Espaziazioak:</h5>
                                <ul style="margin-left: 20px; line-height: 1.8;">
                                    <li>ğŸ”¤ <strong>Hitz arteko espazioa</strong> - 0.15em (normala: 0em)</li>
                                    <li>ğŸ“ <strong>Lerro arteko altuera</strong> - 2.0x (normala: 1.6x)</li>
                                    <li>ğŸ“„ <strong>Paragrafo marjina</strong> - 20px (normala: 15px)</li>
                                </ul>
                            </div>
                            
                            <div style="background: #e7d4f5; padding: 10px; border-radius: 8px;">
                                <p style="margin: 0;"><strong>ğŸ“ Onura:</strong> Dislexia edo beste irakurketa zailtasunak dituzten ikasleentzako.</p>
                            </div>
                        </div>
                        
                        <!-- Azpitituluak -->
                        <div class="feature-item" style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 4px solid #17a2b8;">
                            <h4 style="color: #17a2b8; margin-bottom: 10px;">ğŸ“ Azpitituluak (Bideoan)</h4>
                            <p style="margin-bottom: 15px;"><strong>Zer da?</strong> YouTube bideoetan azpitituluak gaituta, entzumen arazoak dituzten ikasleentzako.</p>
                            
                            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                                <h5 style="color: #17a2b8; margin-bottom: 8px;">Ezaugarriak:</h5>
                                <ul style="margin-left: 20px; line-height: 1.8;">
                                    <li>ğŸ“¹ <strong>Euskarazko azpitituluak</strong> - Bideo guztietarako</li>
                                    <li>ğŸŒ <strong>Gaztelaniazko azpitituluak</strong> - Aukeran disponible</li>
                                    <li>âš™ï¸ <strong>YouTube kontrolak</strong> - Azpitituluak aktibatu/desaktibatzeko</li>
                                </ul>
                            </div>
                            
                            <div style="background: #d1ecf1; padding: 10px; border-radius: 8px;">
                                <p style="margin: 0;"><strong>ğŸ“ Onura:</strong> Entzumen arazoak edo hizkuntza zailtasunak dituzten ikasleentzako.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="task-card" style="background: #e8f5e9;">
                    <h3 style="color: #2e7d32;">âœ… Lorpen Adierazlea</h3>
                    <p style="font-size: 1.05em;">
                        <strong>"Aurkeztutako eduki guztietan irisgarritasuna bermatzeko elementuren bat txertatu da"</strong>
                    </p>
                    <p style="margin-top: 10px;">âœ“ <strong>Betetzen da:</strong> 6 irisgarritasun elementu desberdin inplementatu dira portfolio osoan.</p>
                </div>
            </section>

            <!-- 5.B ATAZA: PERTSONALIZAZIOA -->
            <section id="pertsonalizazioa">
                <h2>ğŸ¯ 5.B Ataza: Ikaskuntza Pertsonalizazioa</h2>
                
                <div class="task-card">
                    <h3>ğŸ¯ Helburua</h3>
                    <p>Ikasleen aztarna digitala erabiliz, ikaskuntza pertsonalizatzeko estrategiak aplikatzea.</p>
                </div>
                
                <div class="task-card">
                    <h3>ğŸ“Š Pertsonalizazio Estrategiak</h3>
                    
                    <div style="background: #e3f2fd; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                        <h4 style="color: #1976d2; margin-bottom: 15px;">1ï¸âƒ£ Aurre-Ebaluazioa (4.A Ataza)</h4>
                        <p style="margin-bottom: 15px;">Google Forms bidez 10 galderako test bat, ikasleen ezagutza maila neurtzeko.</p>
                        <ul style="margin-left: 20px; line-height: 1.8;">
                            <li>ğŸ“Š <strong>Puntuazio sistema:</strong> 0-10 puntu</li>
                            <li>ğŸ”€ <strong>Bideratzea:</strong>
                                <ul style="margin-left: 20px; margin-top: 10px;">
                                    <li>0-7 puntu â†’ 2.A Oinarrizko Edukira</li>
                                    <li>8-10 puntu â†’ 2.B Eduki Aurreratua</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    
                    <div style="background: #f3e5f5; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                        <h4 style="color: #7b1fa2; margin-bottom: 15px;">2ï¸âƒ£ Bi Eduki Maila</h4>
                        <p style="margin-bottom: 15px;">Ezagutza maila desberdinetarako bi eduki sortuta:</p>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                            <div style="background: white; padding: 15px; border-radius: 8px;">
                                <h5 style="color: #28a745;">ğŸ“š 2.A Oinarrizko Edukia</h5>
                                <ul style="margin-left: 20px; margin-top: 10px; line-height: 1.6;">
                                    <li>Kontzeptu oinarrizkoak</li>
                                    <li>Adibide sinpleak</li>
                                    <li>Pauso-pausoko azalpenak</li>
                                    <li>H5P Jarduera interaktiboak</li>
                                </ul>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 8px;">
                                <h5 style="color: #dc3545;">ğŸš€ 2.B Eduki Aurreratua</h5>
                                <ul style="margin-left: 20px; margin-top: 10px; line-height: 1.6;">
                                    <li>Kontzeptu aurreratuak</li>
                                    <li>Kasu praktiko konplexuak</li>
                                    <li>Praktikak Jupyter Notebook-ekin</li>
                                    <li>Proiektu errealistak</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: #fff3cd; padding: 20px; border-radius: 10px;">
                        <h4 style="color: #856404; margin-bottom: 15px;">3ï¸âƒ£ Jarraipena eta Feedback-a</h4>
                        <p style="margin-bottom: 15px;">Kahoot dinamika bat ezagutza ziurtatzeko eta motibatzeko:</p>
                        <ul style="margin-left: 20px; line-height: 1.8;">
                            <li>ğŸ® <strong>Kahoot jokoa:</strong> Ikasitako kontzeptuak berrikusteko</li>
                            <li>ğŸ“ˆ <strong>Emaitza analisia:</strong> Zailtasun guneak identifikatzeko</li>
                            <li>ğŸ”„ <strong>Egokitzapena:</strong> Behar izanez gero, edukia egokitzeko</li>
                        </ul>
                    </div>
                </div>
                
                <div class="task-card" style="background: #e8f5e9;">
                    <h3 style="color: #2e7d32;">âœ… Lorpen Adierazlea</h3>
                    <p style="font-size: 1.05em;">
                        <strong>"Teknologia digitalak erabiliz ikasleak identifikatu eta sailkatu dira"</strong>
                    </p>
                    <p style="margin-top: 10px;">âœ“ <strong>Betetzen da:</strong> Aurre-ebaluazio sistema bat erabili da ikasleen ezagutza maila neurtzeko eta bideratzeko.</p>
                </div>
            </section>
        </div>

        <!-- IRISGARRITASUN PANELA / PANEL DE ACCESIBILIDAD -->
        <div class="accessibility-panel">
            <button class="accessibility-toggle" onclick="toggleAccessibility()">âš™ï¸</button>
            <div class="accessibility-options" id="accessibilityOptions">
                <h3>â™¿ Irisgarritasun Aukerak</h3>
                
                <div class="accessibility-option">
                    <input type="checkbox" id="readingMode" />
                    <label for="readingMode">ğŸ“– Irakurketa Modua</label>
                </div>
                
                <div class="accessibility-option">
                    <input type="checkbox" id="highContrast" />
                    <label for="highContrast">âš«âšª Kontraste Altua</label>
                </div>
                
                <div class="accessibility-option">
                    <input type="checkbox" id="largeText" />
                    <label for="largeText">ğŸ” Testu Handiagoa</label>
                </div>
                
                <div class="accessibility-option">
                    <input type="checkbox" id="wideSpacing" />
                    <label for="wideSpacing">â†”ï¸ Espaziamendu Zabala</label>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Toggle accesibilidad panel
        function toggleAccessibility() {
            const options = document.getElementById('accessibilityOptions');
            options.style.display = options.style.display === 'none' ? 'block' : 'none';
        }

        // Modo de lectura
        document.getElementById('readingMode').addEventListener('change', function() {
            document.body.classList.toggle('reading-mode', this.checked);
            localStorage.setItem('readingMode', this.checked);
        });

        // Alto contraste
        document.getElementById('highContrast').addEventListener('change', function() {
            document.body.classList.toggle('high-contrast', this.checked);
            localStorage.setItem('highContrast', this.checked);
        });

        // Texto grande
        document.getElementById('largeText').addEventListener('change', function() {
            document.body.classList.toggle('large-text', this.checked);
            localStorage.setItem('largeText', this.checked);
        });

        // Espaciado amplio
        document.getElementById('wideSpacing').addEventListener('change', function() {
            document.body.classList.toggle('wide-spacing', this.checked);
            localStorage.setItem('wideSpacing', this.checked);
        });

        // Restaurar preferencias guardadas
        window.addEventListener('load', () => {
            if (localStorage.getItem('readingMode') === 'true') {
                document.getElementById('readingMode').checked = true;
                document.body.classList.add('reading-mode');
            }
            if (localStorage.getItem('highContrast') === 'true') {
                document.getElementById('highContrast').checked = true;
                document.body.classList.add('high-contrast');
            }
            if (localStorage.getItem('largeText') === 'true') {
                document.getElementById('largeText').checked = true;
                document.body.classList.add('large-text');
            }
            if (localStorage.getItem('wideSpacing') === 'true') {
                document.getElementById('wideSpacing').checked = true;
                document.body.classList.add('wide-spacing');
            }
        });
    </script>
    
    <!-- AUDIO READER SCRIPT / IRAKURKETA AUDIO SCRIPT -->
    <script>
        let isReading = false;
        let isPaused = false;
        let utterance = null;
        let currentIndex = 0;
        let contentElements = [];
        let availableVoices = [];
        let selectedLanguage = 'es-ES';
        
        function loadVoices() {
            availableVoices = window.speechSynthesis.getVoices();
            console.log('Voces disponibles:', availableVoices.map(v => v.lang + ' - ' + v.name));
            updateLanguageOptions();
        }
        
        function updateLanguageOptions() {
            const select = document.getElementById('languageSelect');
            const hasBasque = availableVoices.some(v => v.lang.startsWith('eu'));
            
            Array.from(select.options).forEach(option => {
                const lang = option.value.substring(0, 2);
                if (lang === 'eu' && !hasBasque) {
                    option.disabled = true;
                    option.text += ' (Ez dago erabilgarri)';
                }
            });
        }
        
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = loadVoices;
        }
        loadVoices();
        
        function openAudioPanel() {
            document.getElementById('audioReaderPanel').style.display = 'block';
            document.getElementById('audioReaderBtn').style.display = 'none';
        }
        
        function closeAudioPanel() {
            stopAudioReader();
            document.getElementById('audioReaderPanel').style.display = 'none';
            document.getElementById('audioReaderBtn').style.display = 'block';
        }
        
        function changeLanguage() {
            selectedLanguage = document.getElementById('languageSelect').value;
            console.log('Idioma seleccionado:', selectedLanguage);
            
            if (isReading) {
                stopAudioReader();
                setTimeout(startAudioReader, 100);
            }
        }
        
        function togglePlayPause() {
            const btn = document.getElementById('playPauseBtn');
            
            if (!isReading) {
                startAudioReader();
                btn.textContent = 'â¸ï¸ Pause';
                btn.style.background = 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)';
                isReading = true;
                isPaused = false;
            } else if (isPaused) {
                window.speechSynthesis.resume();
                btn.textContent = 'â¸ï¸ Pause';
                isPaused = false;
            } else {
                window.speechSynthesis.pause();
                btn.textContent = 'â–¶ï¸ Play';
                isPaused = true;
            }
        }
        
        function startAudioReader() {
            if (availableVoices.length === 0) {
                loadVoices();
            }
            
            const content = document.querySelector('.content');
            contentElements = Array.from(content.querySelectorAll('h2, h3, h4, p, li'))
                .filter(el => {
                    const text = el.textContent.trim();
                    return text.length > 0 && !el.querySelector('img') && !el.classList.contains('badge');
                });
            
            currentIndex = 0;
            readNextElement();
        }
        
        function readNextElement() {
            if (currentIndex >= contentElements.length || !isReading) {
                stopAudioReader();
                return;
            }
            
            const element = contentElements[currentIndex];
            const text = element.textContent.trim();
            
            element.style.backgroundColor = '#fff3cd';
            element.style.transition = 'background-color 0.3s';
            
            utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = selectedLanguage;
            utterance.rate = 0.85;
            utterance.pitch = 1;
            utterance.volume = 1;
            
            const voice = availableVoices.find(v => v.lang === selectedLanguage) || 
                         availableVoices.find(v => v.lang.startsWith(selectedLanguage.substring(0, 2))) ||
                         availableVoices[0];
            if (voice) {
                utterance.voice = voice;
            }
            
            utterance.onend = function() {
                element.style.backgroundColor = '';
                currentIndex++;
                setTimeout(readNextElement, 100);
            };
            
            utterance.onerror = function(event) {
                console.error('Speech synthesis error:', event);
                element.style.backgroundColor = '';
                currentIndex++;
                readNextElement();
            };
            
            window.speechSynthesis.speak(utterance);
        }
        
        function stopAudioReader() {
            window.speechSynthesis.cancel();
            isReading = false;
            isPaused = false;
            currentIndex = 0;
            
            contentElements.forEach(el => {
                if (el && el.style) {
                    el.style.backgroundColor = '';
                }
            });
            
            const btn = document.getElementById('playPauseBtn');
            if (btn) {
                btn.textContent = 'â–¶ï¸ Play';
                btn.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            }
        }
        
        window.addEventListener('beforeunload', function() {
            stopAudioReader();
        });
    </script>
</body>
</html>
